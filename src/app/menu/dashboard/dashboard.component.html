<div class="dashboard-container">
	<app-sidebar
		[menuItems]="sidebarItems"
		[currentUser]="currentUser"
		[cartCount]="cartCount">
	</app-sidebar>

	<div class="dashboard-content">
		<div class="dashboard-header">
			<div class="header-title">
				<h1>Dashboard <span class="japanese-text">ダッシュボード</span></h1>
				<p class="header-subtitle">Resumen de operaciones del día</p>
			</div>
		</div>

		<div class="dashboard-stats">
			@for (stat of statCards; track stat.title) {
				<app-stat-card
					[title]="stat.title"
					[value]="stat.value"
					[subtitle]="stat.subtitle ?? ''"
					[trendLabel]="stat.trendLabel ?? ''"
					[trendDirection]="stat.trendDirection ?? ''"
					[iconSvg]="stat.iconSvg"
					[variant]="stat.variant">
				</app-stat-card>
			}
		</div>

		<div class="dashboard-grid">
			<div class="chart-section">
				<div class="section-header">
					<h2>Ingresos de la Semana</h2>
				</div>
				<div class="chart-container" (mouseleave)="onChartLeave()">
					<svg viewBox="0 0 600 300" class="chart-svg" (mousemove)="onChartMove($event)">
						<!-- Grid lines -->
						<line x1="50" y1="50" x2="50" y2="250" stroke="rgba(255,255,255,0.1)" stroke-width="1"/>
						<line x1="50" y1="250" x2="580" y2="250" stroke="rgba(255,255,255,0.1)" stroke-width="1"/>

						<!-- Horizontal grid -->
						<line x1="50" y1="200" x2="580" y2="200" stroke="rgba(255,255,255,0.05)" stroke-width="1"/>
						<line x1="50" y1="150" x2="580" y2="150" stroke="rgba(255,255,255,0.05)" stroke-width="1"/>
						<line x1="50" y1="100" x2="580" y2="100" stroke="rgba(255,255,255,0.05)" stroke-width="1"/>

						<!-- Y-axis labels -->
						<text x="35" y="255" font-size="12" fill="#6b7280" text-anchor="end">$0k</text>
						<text x="35" y="205" font-size="12" fill="#6b7280" text-anchor="end">$15k</text>
						<text x="35" y="155" font-size="12" fill="#6b7280" text-anchor="end">$30k</text>
						<text x="35" y="105" font-size="12" fill="#6b7280" text-anchor="end">$45k</text>
						<text x="35" y="55" font-size="12" fill="#6b7280" text-anchor="end">$60k</text>

						<!-- Area -->
						<defs>
							<linearGradient id="areaGradient" x1="0%" y1="0%" x2="0%" y2="100%">
								<stop offset="0%" style="stop-color:#dc2626;stop-opacity:0.3" />
								<stop offset="100%" style="stop-color:#dc2626;stop-opacity:0" />
							</linearGradient>
						</defs>
						<path d="M 70 180 Q 130 140, 190 160 T 310 100 T 430 120 T 550 80 L 550 250 L 70 250 Z" fill="url(#areaGradient)"/>
						<polyline points="70,180 130,140 190,160 250,110 310,100 370,130 430,120 490,100 550,80" stroke="#dc2626" stroke-width="2" fill="none"/>

						<!-- Interactive points -->
						<circle cx="70" cy="180" r="5" fill="rgba(220, 38, 38, 0.2)" stroke="#dc2626" stroke-width="2" class="chart-point" (mouseenter)="onChartHover($event, 'Lun', 35000)" (mousemove)="onChartHover($event, 'Lun', 35000)" style="cursor: pointer;"/>
						<circle cx="130" cy="140" r="5" fill="rgba(220, 38, 38, 0.2)" stroke="#dc2626" stroke-width="2" class="chart-point" (mouseenter)="onChartHover($event, 'Mar', 32000)" (mousemove)="onChartHover($event, 'Mar', 32000)" style="cursor: pointer;"/>
						<circle cx="190" cy="160" r="5" fill="rgba(220, 38, 38, 0.2)" stroke="#dc2626" stroke-width="2" class="chart-point" (mouseenter)="onChartHover($event, 'Mié', 38000)" (mousemove)="onChartHover($event, 'Mié', 38000)" style="cursor: pointer;"/>
						<circle cx="250" cy="110" r="5" fill="rgba(220, 38, 38, 0.2)" stroke="#dc2626" stroke-width="2" class="chart-point" (mouseenter)="onChartHover($event, 'Jue', 28000)" (mousemove)="onChartHover($event, 'Jue', 28000)" style="cursor: pointer;"/>
						<circle cx="310" cy="100" r="5" fill="rgba(220, 38, 38, 0.2)" stroke="#dc2626" stroke-width="2" class="chart-point" (mouseenter)="onChartHover($event, 'Vie', 45000)" (mousemove)="onChartHover($event, 'Vie', 45000)" style="cursor: pointer;"/>
						<circle cx="370" cy="130" r="5" fill="rgba(220, 38, 38, 0.2)" stroke="#dc2626" stroke-width="2" class="chart-point" (mouseenter)="onChartHover($event, 'Sáb', 52000)" (mousemove)="onChartHover($event, 'Sáb', 52000)" style="cursor: pointer;"/>
						<circle cx="430" cy="120" r="5" fill="rgba(220, 38, 38, 0.2)" stroke="#dc2626" stroke-width="2" class="chart-point" (mouseenter)="onChartHover($event, 'Dom', 48000)" (mousemove)="onChartHover($event, 'Dom', 48000)" style="cursor: pointer;"/>

						<!-- X-axis labels -->
						<text x="70" y="275" font-size="12" fill="#6b7280" text-anchor="middle">Lun</text>
						<text x="130" y="275" font-size="12" fill="#6b7280" text-anchor="middle">Mar</text>
						<text x="190" y="275" font-size="12" fill="#6b7280" text-anchor="middle">Mié</text>
						<text x="250" y="275" font-size="12" fill="#6b7280" text-anchor="middle">Jue</text>
						<text x="310" y="275" font-size="12" fill="#6b7280" text-anchor="middle">Vie</text>
						<text x="370" y="275" font-size="12" fill="#6b7280" text-anchor="middle">Sáb</text>
						<text x="430" y="275" font-size="12" fill="#6b7280" text-anchor="middle">Dom</text>
					</svg>
					@if (tooltipVisible) {
						<div class="chart-tooltip" [style.left.px]="tooltipX" [style.top.px]="tooltipY">
							<div class="tooltip-day">{{ tooltipDay }}</div>
							<div class="tooltip-value">{{ tooltipValue }}</div>
						</div>
					}
				</div>
			</div>

			<div class="top-products-section">
				<div class="section-header">
					<h2>Más Vendidos Hoy</h2>
				</div>
				<div class="products-list">
					@for (product of topProducts; track product.id) {
						<div class="product-row" [class]="'rank-' + product.rank">
							<div class="product-rank">{{ product.rank }}</div>
							<div class="product-name">{{ product.name }}</div>
							<div class="product-bar">
								<div class="bar-fill" [style.width.%]="(product.quantity / topProducts[0].quantity) * 100"></div>
							</div>
							<div class="product-quantity">{{ product.quantity }}</div>
						</div>
					}
				</div>
			</div>
		</div>

		<div class="recent-orders-section">
			<div class="section-header">
				<h2>Órdenes Recientes</h2>
			</div>
			<div class="orders-table">
				@for (order of recentOrders; track order.id) {
					<div class="order-row" [class]="'status-' + order.status">
						<div class="order-table-num">
							<span>{{ order.tableNumber }}</span>
						</div>
						<div class="order-info">
							<div class="order-items">{{ order.itemsCount }} items</div>
							<div class="order-customer">{{ order.customerName }}</div>
						</div>
						<div class="order-total">{{ order.total | currency }}</div>
						<div class="order-status" [class]="'badge-' + order.status">
							{{ order.statusLabel }}
						</div>
					</div>
				}
			</div>
		</div>
	</div>
</div>
