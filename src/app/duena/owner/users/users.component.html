<div class="users-container" [class.embedded]="embedded">
	@if (!embedded) {
		<app-sidebar
			[menuItems]="sidebarItems"
			[currentUser]="currentUser"
			[cartCount]="cartCount">
		</app-sidebar>
	}

	<div class="users-content">
		<div class="users-header">
			<div class="header-title">
				<h1>Usuarios <span class="japanese-text">ユーザー</span></h1>
				<p class="header-subtitle">Gestión de empleados y sus roles</p>
			</div>
			<button class="new-user-btn" type="button" (click)="openUserForm()">
				<svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
				</svg>
				Nuevo Usuario
			</button>
		</div>

		<div class="roles-stats">
			@for (role of roleStats; track role.id) {
				<div class="role-card" [class]="'role-' + role.id">
					<div class="role-icon" [innerHTML]="role.icon"></div>
					<div class="role-value">{{ role.count }}</div>
					<div class="role-label">{{ role.label }}</div>
				</div>
			}
		</div>

		<div class="users-grid">
			@if (users.length > 0) {
				@for (user of users; track user.id) {
					<app-user-card
						[name]="user.name"
						[email]="user.email"
						[roleLabel]="getRoleLabel(user.roleId)"
						[roleId]="user.roleId"
						[initials]="user.initials"
						[status]="user.status"
						(edit)="openUserForm(user)"
						(delete)="deleteUser(user.id)">
					</app-user-card>
				}
			} @else {
				<div class="empty-state">
					<svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<path d="M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21M16 7C16 9.20914 14.2091 11 12 11C9.79086 11 8 9.20914 8 7C8 4.79086 9.79086 3 12 3C14.2091 3 16 4.79086 16 7Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
					</svg>
					<h3>No hay usuarios</h3>
					<p>Agrega el primer usuario del sistema</p>
				</div>
			}
		</div>
	</div>
</div>
<!-- User Form Modal -->
<app-user-form
	[isOpen]="showUserFormModal"
	[user]="userBeingEdited"
	[roleOptions]="roleStats"
	(close)="closeUserForm()"
	(save)="saveUser($event)">
</app-user-form>
